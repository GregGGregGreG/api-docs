definitions:
  tqc_check:
    post:
      description: >-
        Perform quality check.
      summary: Perform quality check
      tags:
        - Translation quality check
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - $ref: '../common.yaml#/definitions/pathParameters/accountUid'
        - $ref: '../common.yaml#/definitions/pathParameters/projectId'
        - name: request
          description: ''
          in: body
          required: true
          schema:
            $ref: '#/definitions/TqcCheckRequest'

      responses:
        200:
          description: OK
          schema:
            $ref: '#/definitions/TqcCheckResponse'

      x-code-samples:
        - lang: curl
          source: |
            curl -X POST -H "Authorization: Bearer $smartlingToken" -H "Content-Type: application/json" -d "$smartlingStringTagJSON" https://api.smartling.com/translation-quality-api/v2/accounts/$smartlingAccountId//projects/$smartlingProjectId/check

  TqcCheckRequest:
    allOf:
      - $ref: './common.yaml#/definitions/requestBodyParameter/targetLocaleId'
      - $ref: '../common.yaml#/definitions/requestBodyParameter/sourceLocaleId'
      - type: object
        properties:
          skipSuggestions:
            type: boolean
            description: skip suggestions
            example: false
          excludePlaceholderWithinTag:
            type: boolean
            description: exclude placeholder within tag
            example: true
          strings:
            type: array
            items:
              allOf:
                - $ref: '../common.yaml#/definitions/requestBodyParameter/hashcode'
                - $ref: './common.yaml#/definitions/stringUid'
                - $ref: './common.yaml#/definitions/originalString'
                - $ref: './common.yaml#/definitions/translation'
          useDefaultSettings:
            type: boolean
            description: use default settings
            example: false
          checkTypeCodes:
            minItems: 1
            maxItems: 100
            type: array
            items:
              allOf:
                - $ref: './common.yaml#/definitions/requestBodyParameter/checkTypeCode'


#{
#    "sourceLocaleId": "en-US",
#    "targetLocaleId": "ru-RU",
#    "skipSuggestions": false,
#    "excludePlaceholderWithinTag": true,
#        "strings": [{
#            "hashcode": "7191152182c69d9b72069ac1290fe24b",
#            "originalString": "blacklist_term",
#            "translation": "blacklist_term"
#        }],
#    "checkTypeCodes": [
#        "BLACKLISTED_TERMS"
##    private Boolean useDefaultSettings;
#    ]
#}

#    @Valid
#    private Set<@EnumValue(enumType = QualityCheckType.class) String> checkTypeCodes = new HashSet<>();
#    @LocaleId
#    private String sourceLocaleId;
#    @LocaleId
#    private String targetLocaleId;
#    @Valid
#    @NotEmpty
#    @Size(max = 1000)
#    private Collection<QualityCheckStringCommandDTO> strings = new ArrayList<>();
#    private Boolean skipSuggestions = Boolean.FALSE;
#    private Boolean excludePlaceholderWithinTag = Boolean.FALSE;
#    private Boolean useDefaultSettings;

  TqcCheckResponse:
    allOf:
      - $ref: '../common.yaml#/definitions/SuccessResponse'
      - type: object
        properties:
          data:
            type: object
            properties:
              results:
                type: array
                items:
                  type: object
                  properties:
                    0:
                      type: object
                      properties:
                        string:
                          type: object
                          properties:
                            stringUid:
                              type: string
                              description: it is string part unique identifier if string is splitted on several parts
                              example: ""
                            originalString:
                              type: string
                              description: original string
                              example: "blacklist_term"
                            translation:
                              type: string
                              description: translation of the original string
                              example: "blacklist_term"
                            hashcode:
                              type: string
                              description: string hashcode
                              example: "7191152182c69d9b72069ac1290fe24b"
                        mistakes:
                          type: array
                          items:
                            type: object
                            properties:
                              0:
                                allOf:
                                  - $ref: 'checks/blacklisted_terms.yaml#/definitions/TqcCheckMistakeDTO'
                              1:
                                allOf:
                                  - $ref: 'checks/emoji_consistency.yaml#/definitions/TqcCheckMistakeDTO'
                              2:
                                allOf:
                                  - $ref: 'checks/global_capitalisation_consistency.yaml#/definitions/TqcCheckMistakeDTO'
                              3:
                                allOf:
                                  - $ref: 'checks/glossary_compliance.yaml#/definitions/TqcCheckMistakeDTO'
                              4:
                                allOf:
                                  - $ref: 'checks/grammar_check.yaml#/definitions/TqcCheckMistakeDTO'
                              5:
                                allOf:
                                  - $ref: 'checks/insertable_consistency.yaml#/definitions/TqcCheckMistakeDTO'
                              6:
                                allOf:
                                  - $ref: 'checks/leading_trailing_spaces.yaml#/definitions/TqcCheckMistakeDTO'
                              7:
                                allOf:
                                  - $ref: 'checks/non_translatable_text.yaml#/definitions/TqcCheckMistakeDTO'
                              8:
                                allOf:
                                  - $ref: 'checks/number_consistency.yaml#/definitions/TqcCheckMistakeDTO'
                              9:
                                allOf:
                                  - $ref: 'checks/original_equals_target.yaml#/definitions/TqcCheckMistakeDTO'
                              10:
                                allOf:
                                  - $ref: 'checks/repeated_word.yaml#/definitions/TqcCheckMistakeDTO'
                              11:
                                allOf:
                                  - $ref: 'checks/segment_completeness.yaml#/definitions/TqcCheckMistakeDTO'
                              12:
                                allOf:
                                  - $ref: 'checks/source_in_wrong_language.yaml#/definitions/TqcCheckMistakeDTO'
                              13:
                                allOf:
                                  - $ref: 'checks/spellcheck.yaml#/definitions/TqcCheckMistakeDTO'
                              14:
                                allOf:
                                  - $ref: 'checks/tag_consistency.yaml#/definitions/TqcCheckMistakeDTO'
                              15:
                                allOf:
                                  - $ref: 'checks/target_in_wrong_language.yaml#/definitions/TqcCheckMistakeDTO'
                              16:
                                allOf:
                                  - $ref: 'checks/target_length_limit.yaml#/definitions/TqcCheckMistakeDTO'
                              17:
                                allOf:
                                  - $ref: 'checks/target_source_consistency.yaml#/definitions/TqcCheckMistakeDTO'
                              18:
                                allOf:
                                  - $ref: 'checks/trademark_consistency.yaml#/definitions/TqcCheckMistakeDTO'
                              19:
                                allOf:
                                  - $ref: 'checks/whitespaces.yaml#/definitions/TqcCheckMistakeDTO'

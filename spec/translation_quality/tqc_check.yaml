components:
  schemas:
    tqc_check:
      post:
        description: >-
          Check string translation quality.
        summary: Check string translation quality
        tags:
          - Translation quality check
        consumes:
          - application/json
        produces:
          - application/json
        parameters:
          - $ref: '../api_common.yaml#/components/schemas/pathParameters/accountUid'
          - $ref: '../api_common.yaml#/components/schemas/pathParameters/projectId'
          - name: request
            description: ''
            in: body
            required: true
            schema:
              allOf:
                - $ref: '#/components/schemas/TqcCheckRequest'
                - type: object
                  example:
                    "targetLocaleId": "it-IT"
                    "sourceLocaleId": "en-US"
                    "skipSuggestions": false
                    "excludePlaceholderWithinTag": true
                    "strings":
                      - "hashcode": "7191152182c69d9b72069ac1290fe24b"
                        "stringUid": ""
                        "originalString": "blacklist_term ðŸ˜€"
                        "translation": "blacklist_term"
                    "useDefaultSettings": false
                    "checkTypeCodes":
                      - "checkTypeCode": "BLACKLISTED_TERMS"
                      - "checkTypeCode": "EMOJI_CONSISTENCY"

        responses:
          200:
            description: OK
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/TqcCheckResponse'
                example:
                  "response":
                    "code": "SUCCESS"
                    "data":
                      "results":
                        - "string":
                            "originalString": "blacklist_term ðŸ˜€"
                            "translation": "blacklist_term"
                            "hashcode": "7191152182c69d9b72069ac1290fe24b"
                            "stringUid": null
                          "mistakes":
                            - "checkTypeCode": "BLACKLISTED_TERMS"
                              "severityLevelCode": "MEDIUM"
                              "positions":
                                - "from": 0
                                  "to": 14
                              "details":
                                - "blacklistedTermUid": "uidgj1"
                                  "termText": "blacklist_term"
                                  "alternatives": []
                                  "notes": ""
                              "positionTypeCode": "TARGET"
                            - "checkTypeCode": "EMOJI_CONSISTENCY"
                              "severityLevelCode": "LOW"
                              "positions":
                                - "from": 14
                                  "to": 16
                              "details":
                                - "emoji": "ðŸ˜€"
                                  "type": "EMOJI_DELETED"
                              "positionTypeCode": "SOURCE"
                            - "checkTypeCode": "GLOBAL_CAPITALISATION_CONSISTENCY"
                              "severityLevelCode": "LOW"
                              "positions":
                                - "from": 0
                                  "to": 8
                              "details": null
                              "positionTypeCode": "TARGET"
                            - "checkTypeCode": "GLOSSARY_COMPLIANCE"
                              "severityLevelCode": "MEDIUM"
                              "positions":
                                 - "from": 0
                                   "to": 6
                              "details":
                                "glossaryTerm":
                                  "termUid": "cdd443b9-814f-442c-9ba6-4d97e0afce74"
                                  "translation":
                                      "localeId": "ru-RU"
                                      "translatedTerm": "Ð¸Ð·Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ñ€Ð°Ð·Ð¼ÐµÑ€"
                                      "notes": ""
                                      "translatorUserUid": null
                                      "lockTranslation": false
                                      "submittedForTranslation": false
                                      "createdDate": "2018-11-16T16:06:53Z"
                                      "modifiedDate": "2018-11-16T16:06:53Z"
                                  "termText": "resize"
                                  "caseSensitive": false
                                  "exactMatch": false
                                  "definition": ""
                                  "variations": ""
                                  "synonyms": ""
                                  "antonyms": ""
                                  "seo": false
                                  "doNotTranslate": false
                                  "notes": ""
                                  "partOfSpeechCode": "UNSPECIFIED"
                                  "createdByUserUid": "f64d50d91867"
                                  "createdDate": "2018-11-16T16:06:05Z"
                                  "modifiedDate": "2018-11-16T16:06:05Z"
                              "positionTypeCode": "SOURCE"
                            - "checkTypeCode": "GRAMMAR_CHECK"
                              "severityLevelCode": "LOW"
                              "positions":
                                "from": 9
                                "to": 13
                              "details":
                                "text": "play"
                                "message": "Possible agreement error -- use past participle here: <suggestion>played</suggestion>."
                                "description": "Had + verb present tense"
                                "mistakeTypeCode": "Grammar"
                                "suggestions":
                                  - "played"
                              "positionTypeCode": "TARGET"
                            - "checkTypeCode": "INSERTABLE_CONSISTENCY"
                              "severityLevelCode": "LOW"
                              "positions":
                                - "from": 13
                                  "to": 17
                              "details":
                                "insertable": "<br>"
                                "insertableType": "BR_TAG"
                                "type": "INSERTABLE_DELETED"
                              "positionTypeCode": "SOURCE"
                            - "checkTypeCode": "LEADING_TRAILING_SPACES"
                              "severityLevelCode": "LOW"
                              "positions":
                                - "from": 0
                                  "to": 0
                                - "from": 5
                                  "to": 5
                              "details": null
                              "positionTypeCode": "TARGET"
                            - "checkTypeCode": "NON_TRANSLATABLE_TEXT"
                              "severityLevelCode": "MEDIUM"
                              "positions":
                                - "from": 6
                                  "to": 9
                              "details":
                                "placeable": "{0}"
                                "type": "PLACEABLE_DELETED"
                              "positionTypeCode": "SOURCE"
                            - "checkTypeCode": "NUMBER_CONSISTENCY"
                              "severityLevelCode": "LOW"
                              "positions":
                                - "from": 6
                                  "to": 10
                              "details":
                                "type": "NUMBER_DELETED"
                                "number": "1000"
                              "positionTypeCode": "SOURCE"
                            - "checkTypeCode": "NUMBER_CONSISTENCY"
                              "severityLevelCode": "LOW"
                              "positions":
                                "from": 5
                                "to": 7
                              "details":
                                "type": "NUMBER_ADDED"
                                "number": "20"
                              "positionTypeCode": "TARGET"
                            - "checkTypeCode": "ORIGINAL_EQUALS_TARGET"
                              "severityLevelCode": "LOW"
                              "positions":
                                "from": 0
                                "to": 5
                              "details":
                                "types":
                                  - "IDENTICAL_CAPITALIZATION"
                                  - "IDENTICAL_TAGS"
                              "positionTypeCode": "TARGET"
                            - "checkTypeCode": "REPEATED_WORD"
                              "severityLevelCode": "LOW"
                              "positions":
                                "from": 5
                                "to": 9
                              "details":
                                - "word": "szia"
                              "positionTypeCode": "TARGET"
                            - "checkTypeCode": "SEGMENT_COMPLETENESS"
                              "severityLevelCode": "MEDIUM"
                              "positions":
                                "from": 0
                                "to": 10
                              "details":
                                "type": "TARGET_IS_MUCH_SHORTER_THAN_SOURCE"
                              "positionTypeCode": "TARGET"
                            - "checkTypeCode": "SOURCE_IN_WRONG_LANGUAGE"
                              "severityLevelCode": "LOW"
                              "positions":
                                "from": 0
                                "to": 63
                              "details": null
                              "positionTypeCode": "SOURCE"
                            - "checkTypeCode": "SPELLCHECK"
                              "severityLevelCode": "MEDIUM"
                              "positions":
                                "from": 0
                                "to": 5
                              "details":
                                  "word": "Sziaa"
                                  "suggestions":
                                    - "Szia"
                                    - "Szita"
                                    - "Szila"
                                    - "Szia a"
                                    - "Szilvia"
                              "positionTypeCode": "TARGET"
                            - "checkTypeCode": "TAG_CONSISTENCY"
                              "severityLevelCode": "MEDIUM"
                              "positions":
                                "from": 8
                                "to": 12
                              "details":
                                  "tag": "</p>"
                                  "type": "TAG_DELETED"
                              "positionTypeCode": "SOURCE"
                            - "checkTypeCode": "TARGET_IN_WRONG_LANGUAGE"
                              "severityLevelCode": "LOW"
                              "positions":
                                "from": 0
                                "to": 64
                              "details": null
                              "positionTypeCode": "TARGET"
                            - "checkTypeCode": "TARGET_LENGTH_LIMIT"
                              "severityLevelCode": "HIGH"
                              "positions":
                                "from": 0
                                "to": 4
                              "details": null
                              "positionTypeCode": "TARGET"
                            - "checkTypeCode": "TARGET_SOURCE_CONSISTENCY"
                              "severityLevelCode": "LOW"
                              "positions":
                                "from": 0
                                "to": 27
                              "details":
                                "type": "SAME_SOURCE_DIFFERENT_TRANSLATIONS"
                                "originalString": "I like to go to the mountains very much."
                                "translation": "Ich mÃ¶chte an den Strand gehen."
                              "positionTypeCode": "TARGET"
                            - "checkTypeCode": "TRADEMARK_CONSISTENCY"
                              "severityLevelCode": "LOW"
                              "positions":
                                "from": 6
                                "to": 7
                              "details":
                                "trademarkTypeCode": "COPYRIGHT"
                              "positionTypeCode": "SOURCE"
                            - "checkTypeCode": "WHITESPACES"
                              "severityLevelCode": "LOW"
                              "positions":
                                "from": 4
                                "to": 6
                              "details": null
                              "positionTypeCode": "TARGET"

        x-code-samples:
          - lang: curl
            source: |
              curl -X POST -H "Authorization: Bearer $smartlingToken" -H "Content-Type: application/json" -d "$smartlingStringTagJSON" https://api.smartling.com/translation-quality-api/v2/accounts/$smartlingAccountId//projects/$smartlingProjectId/check

    TqcCheckRequest:
      allOf:
        - $ref: './tqc_common.yaml#/components/schemas/requestBodyParameter/targetLocaleId'
        - $ref: '../api_common.yaml#/components/schemas/requestBodyParameter/sourceLocaleId'
        - type: object
          properties:
            skipSuggestions:
              type: boolean
              description: skip suggestions
              example: false
            excludePlaceholderWithinTag:
              type: boolean
              description: exclude placeholder within tag
              example: true
            strings:
              type: array
              items:
                allOf:
                  - $ref: '../api_common.yaml#/components/schemas/requestBodyParameter/hashcode'
                  - $ref: './tqc_common.yaml#/components/schemas/stringUid'
                  - $ref: './tqc_common.yaml#/components/schemas/originalString'
                  - $ref: './tqc_common.yaml#/components/schemas/translation'
            useDefaultSettings:
              type: boolean
              description: use default settings
              example: false
            checkTypeCodes:
              minItems: 1
              maxItems: 100
              type: array
              items:
                allOf:
                  - $ref: './tqc_common.yaml#/components/schemas/requestBodyParameter/checkTypeCode'


  #{
  #    "sourceLocaleId": "en-US",
  #    "targetLocaleId": "ru-RU",
  #    "skipSuggestions": false,
  #    "excludePlaceholderWithinTag": true,
  #        "strings": [{
  #            "hashcode": "7191152182c69d9b72069ac1290fe24b",
  #            "originalString": "blacklist_term",
  #            "translation": "blacklist_term"
  #        }],
  #    "checkTypeCodes": [
  #        "BLACKLISTED_TERMS"
  ##    private Boolean useDefaultSettings;
  #    ]
  #}

  #    @Valid
  #    private Set<@EnumValue(enumType = QualityCheckType.class) String> checkTypeCodes = new HashSet<>();
  #    @LocaleId
  #    private String sourceLocaleId;
  #    @LocaleId
  #    private String targetLocaleId;
  #    @Valid
  #    @NotEmpty
  #    @Size(max = 1000)
  #    private Collection<QualityCheckStringCommandDTO> strings = new ArrayList<>();
  #    private Boolean skipSuggestions = Boolean.FALSE;
  #    private Boolean excludePlaceholderWithinTag = Boolean.FALSE;
  #    private Boolean useDefaultSettings;

    TqcCheckResponse:
      allOf:
        - $ref: '../api_common.yaml#/components/schemas/SuccessResponse'
        - type: object
          properties:
            data:
              type: object
              properties:
                results:
                  type: array
                  items:
                    type: object
                    properties:
                      string:
                        type: object
                        properties:
                          stringUid:
                            type: string
                            description: it is string part unique identifier if string is splitted on several parts
                            example: ""
                          originalString:
                            type: string
                            description: original string
                            example: "blacklist_term"
                          translation:
                            type: string
                            description: translation of the original string
                            example: "blacklist_term"
                          hashcode:
                            type: string
                            description: string hashcode
                            example: "7191152182c69d9b72069ac1290fe24b"
                      mistakes:
                        type: array
                        items:
                          oneOf:
                            - $ref: 'checks/blacklisted_terms.yaml#/components/schemas/TqcCheckMistakeDTO'
                            - $ref: 'checks/emoji_consistency.yaml#/components/schemas/TqcCheckMistakeDTO'
                            - $ref: 'checks/global_capitalisation_consistency.yaml#/components/schemas/TqcCheckMistakeDTO'
                            - $ref: 'checks/glossary_compliance.yaml#/components/schemas/TqcCheckMistakeDTO'
                            - $ref: 'checks/grammar_check.yaml#/components/schemas/TqcCheckMistakeDTO'
                            - $ref: 'checks/insertable_consistency.yaml#/components/schemas/TqcCheckMistakeDTO'
                            - $ref: 'checks/leading_trailing_spaces.yaml#/components/schemas/TqcCheckMistakeDTO'
                            - $ref: 'checks/non_translatable_text.yaml#/components/schemas/TqcCheckMistakeDTO'
                            - $ref: 'checks/number_consistency.yaml#/components/schemas/TqcCheckMistakeDTO'
                            - $ref: 'checks/original_equals_target.yaml#/components/schemas/TqcCheckMistakeDTO'
                            - $ref: 'checks/repeated_word.yaml#/components/schemas/TqcCheckMistakeDTO'
                            - $ref: 'checks/segment_completeness.yaml#/components/schemas/TqcCheckMistakeDTO'
                            - $ref: 'checks/source_in_wrong_language.yaml#/components/schemas/TqcCheckMistakeDTO'
                            - $ref: 'checks/spellcheck.yaml#/components/schemas/TqcCheckMistakeDTO'
                            - $ref: 'checks/tag_consistency.yaml#/components/schemas/TqcCheckMistakeDTO'
                            - $ref: 'checks/target_in_wrong_language.yaml#/components/schemas/TqcCheckMistakeDTO'
                            - $ref: 'checks/target_length_limit.yaml#/components/schemas/TqcCheckMistakeDTO'
                            - $ref: 'checks/target_source_consistency.yaml#/components/schemas/TqcCheckMistakeDTO'
                            - $ref: 'checks/trademark_consistency.yaml#/components/schemas/TqcCheckMistakeDTO'
                            - $ref: 'checks/whitespaces.yaml#/components/schemas/TqcCheckMistakeDTO'
